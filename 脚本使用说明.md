# 图书管理系统数据生成与导入工具 使用说明

本工具用于生成图书管理系统的假数据，并支持将数据导入 Excel 或 SQL Server 数据库。支持命令行操作，适合批量数据生成、测试和数据初始化。

## 一、基本用法

在命令行中运行：

```bash
python main.py <command> [options]
```

其中 `<command>` 为 `generate`（生成数据）或 `import`（导入数据）。

---

## 二、命令与参数说明

### 1. 生成假数据（generate）

生成指定表的假数据，并可选择保存为 Excel 文件或直接插入数据库。

**命令格式：**

```bash
python main.py generate [--table <表名>] [--count <数量>] [--output <文件名>] [--db] [--new]
```

**参数说明：**

- `--table`指定要生成数据的表。可选值：

  - bookshelfslot（书架格子表）
  - book（图书表）
  - user（用户表）
  - admin（管理员表）
  - borrow（借阅记录表）
  - all（所有表，默认）

- `--count`生成数据的数量（默认：10）
- `--output`输出 Excel 文件名（默认：library_data.xlsx）
- `--db`生成数据后，是否同时插入数据库（加上此参数则插入数据库）
- `--new`
  如果输出文件已存在，则删除并新建

**示例：**

- 生成所有表的 20 条数据，保存为 `data.xlsx`，并插入数据库：

  ```bash
  python main.py generate --count 20 --output data.xlsx --db
  ```

- 只生成 5 条用户数据，保存为默认 Excel 文件：

  ```bash
  python main.py generate --table user --count 5
  ```

---

### 2. 导入数据（import）

从 Excel 文件导入数据，可选择插入数据库。

**命令格式：**

```bash
python main.py import --excel <文件路径> [--table <表名>] [--db]
```

**参数说明：**

- `--excel`指定要导入的 Excel 文件路径（必填）
- `--table`指定要导入的表。可选值同上，默认 all（导入所有表）
- `--db`
  是否将导入的数据插入数据库（加上此参数则插入数据库）

**示例：**

- 导入 `data.xlsx` 中所有表的数据到数据库：

  ```bash
  python main.py import --excel data.xlsx --db
  ```

- 只导入 `data.xlsx` 中的图书表数据，不插入数据库：

  ```bash
  python main.py import --excel data.xlsx --table book
  ```

---

## 三、数据库配置

- 默认连接字符串为本地 SQL Server Express，数据库名为 `LibrBook`，使用 Windows 身份验证。
- 如需修改数据库连接，请在 `main.py` 中调整 `conn_str` 变量。

---

## 四、常见问题

- 需确保已安装所需依赖（见 `requirements.txt`）。
- 运行前请确保 SQL Server 服务已启动，且有对应数据库。
- Excel 文件格式需与本工具生成的格式一致。
